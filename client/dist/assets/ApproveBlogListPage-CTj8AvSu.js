import{U as f,r as a,d as b,j as e,L as c,a as B}from"./index-B5C5FMOL.js";import{B as L}from"./blogStore-H7XvcH8P.js";import{L as v}from"./Layout-BfqDdB07.js";import{L as y,s as t}from"./Login-WYuVgNSc.js";import{a as N}from"./index-Bu6yC-yO.js";import{R as A}from"./index-gSGGPaA2.js";import{B as w}from"./BlogListLayout-hbwzdHLj.js";import"./AdminDashboardLayout-DDgfdnAM.js";const I=()=>{const{isLogin:i}=f(),{ApprovedBlogList:d,ApprovedBlogListRequest:x,ApproveBlogListByUser:h,ApproveBlogListRequestByUser:m}=L(),r=sessionStorage.getItem("role"),[g,j]=a.useState(!1);a.useEffect(()=>{i()&&(r==="admin"?x():r==="user"?m():(b.remove("token"),sessionStorage.clear()))},[i,g]);const u=async s=>{t({title:"Are you sure?",text:"You cannot recover this blog after deletion!",icon:"warning",buttons:!0,dangerMode:!0}).then(async o=>{if(!o)return t("Your blog is safe!");try{const l=r==="admin"?`/api/v1/DeleteBlog/${s}`:`/api/v1/DeleteBlogByUser/${s}`;(await B.delete(l)).data.status==="success"?(t("Blog deleted successfully!",{icon:"success"}),j(p=>!p)):t("Failed to delete!",{icon:"error"})}catch(l){console.error(l),t("Something went wrong!",{icon:"error"})}})};if(!i())return e.jsx(v,{children:e.jsxs("div",{className:"flex flex-col gap-10 items-center justify-center h-screen",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Please Login to Access the Page"}),e.jsx(y,{})]})});const n=r==="admin"?d:h;return e.jsxs(w,{children:[e.jsxs("div",{className:"flex justify-between items-center my-5",children:[e.jsxs("h1",{className:"text-xl font-semibold",children:["Total Blogs: ",n.length]}),e.jsx(c,{to:"/dashboard/writeBlog",className:"btn btn-outline btn-primary",children:"Write a Blog"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"SL"}),e.jsx("th",{children:"Photo"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:n.map((s,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:o+1}),e.jsx("td",{children:e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"mask mask-squircle h-12 w-12",children:e.jsx("img",{src:s.img,alt:"blog"})})})}),e.jsx("td",{className:"font-bold",children:s.title.slice(0,100)}),e.jsx("td",{children:e.jsx("p",{className:"text-sm text-gray-700 leading-snug",children:s.des.replace(/<[^>]+>/g,"").slice(0,200)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(c,{to:`/dashboard/editblog/${s._id}`,className:"btn btn-ghost btn-xs text-lg",children:e.jsx(N,{})}),e.jsxs("button",{onClick:()=>u(s._id),className:"btn btn-soft btn-error btn-xs text-md",children:[" ",e.jsx(A,{})]})]})})]},s._id))})]})})]})};export{I as default};
