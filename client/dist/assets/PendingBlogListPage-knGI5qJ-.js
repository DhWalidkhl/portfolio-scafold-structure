import{U as y,r as d,d as L,j as e,L as x,a as h}from"./index-DhF9NZF3.js";import{B as v}from"./blogStore-fbPhHqk6.js";import{L as N}from"./Layout-D1OdYfqz.js";import{L as w,s as r}from"./Login-DEwbf6GI.js";import{a as P}from"./index-B8flHTMB.js";import{R as S}from"./index-BF_cJBhq.js";import{B as A}from"./BlogListLayout-sUZ4j1hv.js";import"./AdminDashboardLayout-EIMp_-y_.js";const I=()=>{const{isLogin:i}=y(),{PendingBlogList:m,PendingBlogListRequest:g,PendingBlogListByUser:j,PendingBlogListRequestByUser:u}=v(),n=sessionStorage.getItem("role"),[p,l]=d.useState(!1);d.useEffect(()=>{i()&&(n==="admin"?g():n==="user"?u():(L.remove("token"),sessionStorage.clear()))},[i,p]);const f=s=>{r({title:"Are you sure?",text:"You cannot recover this blog after deletion!",icon:"warning",buttons:!0,dangerMode:!0}).then(async t=>{if(!t)return r("Your blog is safe!");try{const o=n==="admin"?`/api/v1/DeleteBlog/${s}`:`/api/v1/DeleteBlogByUser/${s}`;(await h.delete(o)).data.status==="success"?(r("Blog Deleted!",{icon:"success"}),l(B=>!B)):r("Failed to delete!",{icon:"error"})}catch(o){console.error(o),r("Something went wrong!",{icon:"error"})}})},b=async s=>{if(n==="admin")try{await h.post(`/api/v1/ApproveBlog/${s}`),r("Blog Approved Successfully!",{icon:"success"}),l(t=>!t)}catch(t){console.error(t),r("Something went wrong!",{icon:"error"})}};if(!i())return e.jsx(N,{children:e.jsxs("div",{className:"flex flex-col gap-10 items-center justify-center h-screen",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Please Login to Access the Page"}),e.jsx(w,{})]})});const a=n==="admin",c=a?m:j;return e.jsxs(A,{children:[e.jsxs("div",{className:"flex justify-between items-center my-5",children:[e.jsxs("h1",{className:"text-xl font-semibold",children:["Total Blogs: ",c.length]}),e.jsx(x,{to:"/dashboard/writeBlog",className:"btn btn-outline btn-primary",children:"Write a Blog"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"SL"}),e.jsx("th",{children:"Photo"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:c.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"mask mask-squircle h-12 w-12",children:e.jsx("img",{src:s.img,alt:"blog"})})})}),e.jsx("td",{className:"font-bold",children:s.title.slice(0,100)}),e.jsx("td",{children:e.jsx("p",{className:"text-sm text-gray-700 leading-snug",children:s.des.replace(/<[^>]+>/g,"").slice(0,200)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{to:`/dashboard/editblog/${s._id}`,className:"btn btn-ghost btn-xs text-lg",children:e.jsx(P,{})}),e.jsx("button",{onClick:()=>f(s._id),className:"btn btn-error btn-xs",children:e.jsx(S,{})}),a&&e.jsx("button",{onClick:()=>b(s._id),className:"btn btn-warning btn-xs",children:"Approve"})]})})]},s._id))})]})})]})};export{I as default};
